/*! AgileAndBeyond 2013-12-03 */
var controllers={};controllers.homeController=function(){},controllers.mainController=function(a,b){a.sessionData={},b.acceptingProposals=!1,a.auth={},a.review={showWidget:!1},$("#authorized").length>0&&(a.auth.isAuthenticated=!0),a.aUrl=b.location.absUrl();var c=new Date("Mon Sep 30 2013"),d=new Date("Tue Nov 11 2013"),e=new Date;e>=c&&d>=e&&(b.acceptingProposals=!0),a.pages=[{page:"Home"},{page:"Location"},{page:"Sessions"},{page:"Presenters"},{page:"Sponsors"},{page:"Team"}],a.setActive=function(b){a.selected=b},a.setActive(a.pages[0]),a.itemClass=function(b){return b===a.selected?"active":void 0}},controllers.sessionsController=function(a,b,c){a.sessionYear="",a.getSessions=function(b){b.target.innerText&&""!=b.target.innerText&&(a.sessionYear=b.target.innerText),c.getAllSessions(a.sessionYear).success(function(b){a.sessionData=b})}},controllers.sessionsViewController=function(a,b,c){a.sessionData=null,b.getSessionDetails($.param(c)).success(function(b){a.sessionData=b,console.log(a.sessionData)})},controllers.speakerSubmissionController=function(a,b,c,d){a.defaultForm={firstName:"",middleName:"",lastName:"",email:"",twitter:"",personalSite:"",copresenter:"",copresenterEmail:"",sessionTitle:"",sessionAbstract:"",sessionLevel:"",session_length:"",sessionAudience:"",audienceOther:"",sessionPresented:"",sessionInformation:""},a.isSubmitDisabled=!1,a.showAudienceOtherInput=!1,a.user={},a.resetForm=function(){a.user=a.defaultForm};a.user.sessionAudience;a.$watch("user.sessionAudience",function(b){a.showAudienceOtherInput="undefined"!=typeof b&&"Other..."===b?!0:!1}),a.addSpeakerApplication=function(){a.showAudienceOtherInput&&(a.user.sessionAudience=a.user.audienceOther),a.isSubmitDisabled=!0,d.addSessions($.param(a.user)).success(function(){a.isSubmitDisabled=!1,a.resetForm(),$(".modal").modal({show:!0})})}},controllers.sessionsAdminController=function(a,b,c){a.acceptedSessions=0,a.submittedSessions=0,a.showSessions=!1,a.showLeaders=!1,a.allSessions=null,a.leaderData=null,a.sessionFilters=["Beginner ","Agile Engineering","Team","Organization","Product Development","Personal Development","Other"],c.getSessionData().success(function(b){a.submittedSessions=b.totalNumberOfSessionsSubmitted.number,a.allSessions=b.totalNumberOfSessionsSubmitted.sessions,a.acceptedSessions=b.totalNumberOfAcceptedSessions}),a.getSessions=function(){a.showSessions=a.showSessions===!1?!0:!1},a.getLeaders=function(b,d){var e;a.leaderData=null,a.filterName="null"===d?"Overall":d,e=d?{filter:d}:{filter:null},c.getLeaderboard($.param(e)).success(function(b){a.leaderData=b})}},controllers.itemController=function(a,b,c){a.showVotePanel=function(b,d,e){a.review.speakerRate=0,a.review.contentRate=0,a.review.applicabilityRate=0,a.review.reviewComment="",a.review.sessionAudience="Please choose one...",a.review.positionReviewProp={left:e.pageX-320,top:e.pageY-20},a.review.showWidget=!0,a.review.data=a.allSessions[d];var f={userid:AAB_USER_ID,sessionid:a.review.data.id};c.getSessionVoteById($.param(f)).success(function(b,c){200===c&&(a.review.speakerRate=b[0].speaker,a.review.contentRate=b[0].content,a.review.applicabilityRate=b[0].applicability,a.review.reviewComment=b[0].note,a.review.sessionAudience=b[0].audience)})}},controllers.ratingsWidget=function(a,b){a.review.speakerRate=0,a.review.contentRate=0,a.review.applicabilityRate=0,a.max=5,a.isReadonly=!1;a.hoveringOver=function(b){a.overStar=b,a.percent=100*(b/a.max)},a.saveRating=function(){if(a.review.user=AAB_USER_ID,a.review.contentRate<1||a.review.applicabilityRate<1||a.review.speakerRate<1)return toastr.error("Darn it!  You gotta give a rating for all THREE options.  Thanks for understanding"),void 0;var c={userid:a.review.user,session:a.review.data.id,content:a.review.contentRate,applicability:a.review.applicabilityRate,speaker:a.review.speakerRate,note:a.review.reviewComment,audience:a.review.sessionAudience};b.castVote($.param(c)).success(function(){toastr.success("Your vote has been cast"),a.review.showWidget=!1}).error(function(){toastr.warning("Oh Snap!  there was an error. Our Bad.  Please Try again.")})},a.closeReview=function(){a.review.showWidget=!1,a.review.positionReviewProp={left:"auto",top:"auto"}}},controllers.sponsorController=function(a){a.buyNow=function(){window.open("http://aab14sponsors.eventbrite.com/")}},controllers.userRegistrationController=function(a,b,c){a.addNewUser=function(){c.addUser($.param(a.newUser)).success(function(b){var d={email:b.email,pwd:a.newUser.user_password};c.login($.param(d)).success(function(b){a.auth.isAuthenticated=!0,a.auth.user=b,window.currentUser=b}).error(function(a){console.log(a.status)})}).error(function(a){console.log(a)})}},controllers.updateSession=function(a,b,c){a.updatedSessions={},a.submitedLength={},a.audienceOptions=["Agile Engineering"];var d={id:AAB_ID};d.id&&c.getSessionsById($.param(d)).success(function(b){a.updatedSessions=b}),a.updateLengthOfSession=function(){$.each(a.submitedLength,function(a,b){var d={length:b,sessionid:a};c.updateSession($.param(d)).success(function(){toastr.info("Your session(s) have been updated")})})}},app.controller(controllers);